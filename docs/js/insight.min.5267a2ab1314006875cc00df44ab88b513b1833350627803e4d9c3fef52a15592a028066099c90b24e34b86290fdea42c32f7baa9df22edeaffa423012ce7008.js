(function(e,t){var n=e(".ins-search"),i=n.find(".ins-search-input"),s=n.find(".ins-section-wrapper"),a=n.find(".ins-section-container");n.parent().remove(".ins-search"),e("body").append(n);function _(t){return e("<section>").addClass("ins-section").append(e("<header>").addClass("ins-section-header").text(t))}function l(e,n,s,o,i){var r,c,l,d,a=document.createElement("div");return a.classList.add("ins-selectable"),a.classList.add("ins-search-item"),r=document.createElement("header"),c=document.createElement("i"),c.classList.add("icon"),c.classList.add("icon-"+e),r.appendChild(c),n!=null&&n!=""?r.appendChild(document.createTextNode(n)):r.appendChild(document.createTextNode(t.TRANSLATION.UNTITLED)),s&&(l=document.createElement("span"),l.classList.add("ins-slug"),l.textContent=s,r.appendChild(l)),a.appendChild(r),o&&(d=document.createElement("p"),d.classList.add("ins-search-preview"),d.textContent=o,a.appendChild(d)),a.setAttribute("data-url",i),a}function g(e,n){var s,o;if(n.length===0)return null;switch(o=t.TRANSLATION[e],e){case"POSTS":s=n.map(function(e){return l("file",e.title,null,e.content.slice(0,150),e.uri)});break;case"CATEGORIES":case"TAGS":s=n.map(function(t){return l(e==="CATEGORIES"?"folder":"tag",t.title,"",null,t.uri)});break;default:return null}return _(o).append(s)}function d(e){return e.split(" ").filter(function(e){return!!e}).map(function(e){return e.toUpperCase()})}function o(e,t,n){var i=!1,s=d(e),o=s.filter(function(e){var s=n.filter(function(n){if(!t.hasOwnProperty(n))return!1;if(t[n].toUpperCase().indexOf(e)>-1)return!0});return s.length>0});return o.length===s.length}function p(e){return{POST:function(t){return o(e,t,["title","content"])},PAGE:function(t){return o(e,t,["title","content"])},CATEGORY:function(t){return o(e,t,["title"])},TAG:function(t){return o(e,t,["title"])}}}function c(e,t,n,s){var o=0;return d(e).forEach(function(e){var i=new RegExp(e,"img");n.forEach(function(e,n){if(t.hasOwnProperty(e)){var a=t[e].match(i);o+=a?a.length*s[n]:0}})}),o}function v(e){return{POST:function(t){return c(e,t,["title","content"],[3,1])},PAGE:function(t){return c(e,t,["title","content"],[3,1])},CATEGORY:function(t){return c(e,t,["title"],[1])},TAG:function(t){return c(e,t,["title"],[1])}}}function b(e,t){let n=v(t),s=p(t),o=e.posts,i=e.tags,a=e.categories;return{posts:o.filter(s.POST).sort(function(e,t){return n.POST(t)-n.POST(e)}).slice(0,5),categories:a.filter(s.CATEGORY).sort(function(e,t){return n.CATEGORY(t)-n.CATEGORY(e)}).slice(0,5),tags:i.filter(s.TAG).sort(function(e,t){return n.TAG(t)-n.TAG(e)}).slice(0,5)}}function j(e){a.empty();for(var t in e)a.append(g(t.toUpperCase(),e[t]))}function y(e){if(e.length===0)return;var n=s[0].clientHeight,o=e.position().top-s.scrollTop(),t=e[0].clientHeight+e.position().top;t>n+s.scrollTop()&&s.scrollTop(t-s[0].clientHeight),o<0&&s.scrollTop(e.position().top)}function u(t){var o,n=e.makeArray(a.find(".ins-selectable")),s=-1;n.forEach(function(t,n){if(e(t).hasClass("active")){s=n;return}}),o=(n.length+s+t)%n.length,e(n[s]).removeClass("active"),e(n[o]).addClass("active"),y(e(n[o]))}function h(e){e&&e.length&&(location.href=e.attr("data-url"))}e.getJSON(t.CONTENT_URL,function(t){location.hash.trim()==="#ins-search"&&n.addClass("show"),i.on("input",function(){var n=e(this).val();j(b(t,n))}),i.trigger("input")});let r=0,m=null;function f(e){if(r===0){r+=1,m=setTimeout(()=>r=0,500);return}r=0,clearTimeout(m),e==="show"?n.addClass("show"):n.removeClass("show")}e(document).on("click focus",".search-form-input",function(){n.addClass("show"),i.focus()}).on("click",".ins-search-item",function(){h(e(this))}).on("click",".ins-close",function(){n.removeClass("show")}).on("keydown",function(e){if(!n.hasClass("show")){switch(e.code){case"Shift","ShiftRight","ShiftLeft":f("show"),i.focus()}return}switch(e.code){case"Escape":n.removeClass("show");break;case"ArrowUp":u(-1);break;case"ArrowDown":u(1);break;case"Enter":h(a.find(".ins-selectable.active").eq(0));break;case"Shift","ShiftRight","ShiftLeft":f("close")}})})(jQuery,window.INSIGHT_CONFIG)
<!doctype html>
<html lang="en-us">

<head>
  <title>GraphQL 打招呼 | XiaoXiao Notes</title>
  <meta charset="utf-8" />
  <meta name="generator" content="Hugo 0.62.2" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="Xiao Xiao" />
  <meta name="description"
    content="" />
  <link rel="stylesheet" href="https://blog.10oz.tw/css/main.min.5ade29aff989990df1b116e145537ab55c8452957abda497ceebd8704d182b4c.css" />
  <link rel="shortcut icon" href="https://blog.10oz.tw/favicon.ico">

  
  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="GraphQL 打招呼"/>
<meta name="twitter:description" content="介紹一下 在遇見 GraphQL 的時候最常被比較的就是 Restful API，畢竟 Rustful API 是目前的主流設計，此時我們就必須了解到什麼情況下使用 GraphQL 能帶來效益
 Over Fetch Restful API 的回傳會是一整個 resource， /user/1 會回傳 id=1 的 User 的全部資料，然而在很多情況下我們不需要這麼多的資料，可能 我們僅僅只需要 user 的名字而已 在 GraphQL 你可以指定你所需要的欄位，大大的減少了傳輸無用資料的消耗 Under Fetch 也就是 n&#43;1 問題，情景是 user 有很多的 friends，每個朋友都是一名 User，在 Restful 的設計中，每個 User resource 都是一支 API，想想就頭痛 QQ。因此會在後端客製化 API 做 eager loading，一次回傳這些資料 但到了 GraphQL 這完全不是問題，你可以向下定義你所需要的資料，並嵌入 User 中 query{User(id:1){NameAvatarURLfriends{IDName}}}  在設計上，GraphQL 關注 明確的解釋查詢語言與型態系統 而不去描述伺服器端實作，前後端之間以 Schema 定義溝通介面，雙方有共通的資料型態以及明確定義的詞彙來討論
讓一切清楚且簡單～
怎麼用r 工具會用一點 - GraphQL Playground 認識一些 GraphQL Schema GraphQL 定義自己的語法格式，他是個 SDL (Schema Define Language)"/>

  <meta property="og:title" content="GraphQL 打招呼" />
<meta property="og:description" content="介紹一下 在遇見 GraphQL 的時候最常被比較的就是 Restful API，畢竟 Rustful API 是目前的主流設計，此時我們就必須了解到什麼情況下使用 GraphQL 能帶來效益
 Over Fetch Restful API 的回傳會是一整個 resource， /user/1 會回傳 id=1 的 User 的全部資料，然而在很多情況下我們不需要這麼多的資料，可能 我們僅僅只需要 user 的名字而已 在 GraphQL 你可以指定你所需要的欄位，大大的減少了傳輸無用資料的消耗 Under Fetch 也就是 n&#43;1 問題，情景是 user 有很多的 friends，每個朋友都是一名 User，在 Restful 的設計中，每個 User resource 都是一支 API，想想就頭痛 QQ。因此會在後端客製化 API 做 eager loading，一次回傳這些資料 但到了 GraphQL 這完全不是問題，你可以向下定義你所需要的資料，並嵌入 User 中 query{User(id:1){NameAvatarURLfriends{IDName}}}  在設計上，GraphQL 關注 明確的解釋查詢語言與型態系統 而不去描述伺服器端實作，前後端之間以 Schema 定義溝通介面，雙方有共通的資料型態以及明確定義的詞彙來討論
讓一切清楚且簡單～
怎麼用r 工具會用一點 - GraphQL Playground 認識一些 GraphQL Schema GraphQL 定義自己的語法格式，他是個 SDL (Schema Define Language)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.10oz.tw/20201009-hello-graphql/" />
<meta property="article:published_time" content="2020-10-09T01:17:39+08:00" />
<meta property="article:modified_time" content="2020-10-09T01:17:39+08:00" />

</head>

<body>
    
  <header class="app-header">
    <a href="https://blog.10oz.tw">
      <img class="app-header-avatar" src="/profile.jpg"
        alt="Xiao Xiao" />
      <h1 class="title">XiaoXiao Notes</h1>
    </a>
    <p class="sub-title"> XiaoXiao 的筆記書</p>

    <div class="social-icon">
      
      <a target="_blank" href="https://github.com/XiaoXiaoSN"
        rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
      
    </div>

    <aside>
      <ul class="start-menu">
        
        
        
            <li>
            <a href="/">
                <span>回到文章列表</span>
            </a>
            </li>
        
        
        
            <li>
            <a href="/tags">
                <span>用 Tags 分類</span>
            </a>
            </li>
        
        
        
            <li>
            <a href="/about">
                <span>關於 XiaoXiao</span>
            </a>
            </li>
        
        

      </ul>
    </aside>
  </header>


  <main class="app-container">
    

<article class="post">
  <header class="post-header">
    <h1 class="post-title">GraphQL 打招呼</h1>
    <div class="post-meta">
      <div>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
        Oct 9, 2020
      </div><div>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line>
</svg>
        <a class="tag" href="https://blog.10oz.tw/tags/graphql/">graphql</a><a class="tag" href="https://blog.10oz.tw/tags/gql/">gql</a></div></div>
  </header>

  <aside>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#介紹一下">介紹一下</a></li>
    <li><a href="#怎麼用r">怎麼用r</a>
      <ul>
        <li><a href="#工具會用一點---graphql-playground">工具會用一點 - GraphQL Playground</a></li>
        <li><a href="#認識一些-graphql-schema">認識一些 GraphQL Schema</a></li>
        <li><a href="#語法知道一下-query-mutation-subscription">語法知道一下 (query, mutation, subscription)</a></li>
        <li><a href="#introspection-自我查詢">Introspection 自我查詢</a></li>
      </ul>
    </li>
    <li><a href="#hasura">HASURA</a></li>
    <li><a href="#ref">Ref</a></li>
  </ul>
</nav>
  </aside>

  <div class="post-content">
    <h2 id="介紹一下">介紹一下</h2>
<p>在遇見 GraphQL 的時候最常被比較的就是 Restful API，畢竟 Rustful API 是目前的主流設計，此時我們就必須了解到什麼情況下使用 GraphQL 能帶來效益</p>
<ul>
<li><strong>Over Fetch</strong>
Restful API 的回傳會是一整個 resource， <code>/user/1</code> 會回傳 id=1 的 User 的全部資料，然而在很多情況下我們不需要這麼多的資料，可能 我們僅僅只需要 user 的名字而已
在 GraphQL 你可以指定你所需要的欄位，大大的減少了傳輸無用資料的消耗</li>
<li><strong>Under Fetch</strong>
也就是 n+1 問題，情景是 user 有很多的 friends，每個朋友都是一名 User，在 Restful 的設計中，每個 User resource 都是一支 API，想想就頭痛 QQ。因此會在後端客製化 API 做 eager loading，一次回傳這些資料
但到了 GraphQL 這完全不是問題，你可以向下定義你所需要的資料，並嵌入 User 中
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#007020;font-weight:bold">query</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#0e84b5;font-weight:bold">User</span>(id:<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">1</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">        </span>Name<span style="color:#bbb">
</span><span style="color:#bbb">        </span>AvatarURL<span style="color:#bbb">
</span><span style="color:#bbb">        </span>friends<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">            </span>ID<span style="color:#bbb">
</span><span style="color:#bbb">            </span>Name<span style="color:#bbb">
</span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div></li>
</ul>
<p>在設計上，GraphQL 關注 <strong>明確的解釋查詢語言與型態系統</strong> 而不去描述伺服器端實作，前後端之間以 Schema 定義溝通介面，雙方有共通的資料型態以及明確定義的詞彙來討論<br>
讓一切清楚且簡單～</p>
<h2 id="怎麼用r">怎麼用r</h2>
<h3 id="工具會用一點---graphql-playground">工具會用一點 - GraphQL Playground</h3>
<h3 id="認識一些-graphql-schema">認識一些 GraphQL Schema</h3>
<p>GraphQL 定義自己的語法格式，他是個 SDL (Schema Define Language)</p>
<p>首先來定義一個 <code>type</code> 也就是基本的物件，基本型別有 <code>Int</code> <code>Float</code> <code>String</code> <code>Boolean</code> <code>ID</code>，也可以用 <code>!</code> 來定義該欄位是否是 Nullable 的</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">Student</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span>id:<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">Int</span>!<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">String</span>!<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#4070a0">&#34;可以寫註解說每個學生都有 sid&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>studentID:<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">String</span>!<span style="color:#bbb">
</span><span style="color:#bbb">  
</span><span style="color:#bbb">  </span><span style="color:#4070a0">&#34;&#34;&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>多行註解說<span style="">：</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>每個學生都可以填一個電話<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#4070a0">&#34;&#34;&#34;
</span><span style="color:#4070a0">  phone: Phone
</span><span style="color:#4070a0">  
</span><span style="color:#4070a0">  &#34;&#34;&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>每個人都可以發很多文<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#4070a0">&#34;&#34;&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>articles:<span style="color:#bbb"> </span>[<span style="color:#0e84b5;font-weight:bold">Article</span>!]<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">Phone</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span>phoneNumber:<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">String</span>!<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">Article</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span>title:<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">String</span>!<span style="color:#bbb">
</span><span style="color:#bbb">  </span>content:<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">String</span>!<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p>基本型別不夠用嗎，我們來自定義一下，Date 然後這個型別的實作要伺服器端自己來喔</p>
<pre><code>scalar Date

# 用法這樣
type Article2 {
  title: String!
  content: String!
  date: Date!
}
</code></pre><p>也可以定義枚舉類別(enumeration)</p>
<pre><code>enum GradingStatus {
    INPROGRESS
    GRADUATED
}

type Student2 {
  gradingStatus: GradingStatus!
}
</code></pre><p>當你的物件可能是不同的結構時，你可以找 union</p>
<pre><code>&quot;&quot;&quot;
union 定義 User 可能是 Student 也可能是 Teacher
&quot;&quot;&quot;
union User = Student | Teacher
</code></pre><p>或是 interface 也能滿足你的需求</p>
<pre><code>interface User {
  id: ID!
  name: String!
  phone: Phone
}

type Student implements User {
  id: ID!
  name: String!
  phone: Phone
  
  # 你還可以定義更多更多...
}

type Teacher implements User {
  id: ID!
  name: String!
  phone: Phone
  
  # 你還可以定義更多更多...

}
</code></pre><p>query mutation 驚嘆號
(enum with default)</p>
<h3 id="語法知道一下-query-mutation-subscription">語法知道一下 (query, mutation, subscription)</h3>
<p>有三種基本語法 query, mutation, subscription</p>
<h4 id="query">query</h4>
<p>可以簡單想像他是 RestfulAPI 中的 <code>GET</code>，用來拿各種資料</p>
<p><img src="https://dynalist.io/u/1KC6yOKER8CzIOF_5KELO2jL" alt=""></p>
<p><strong>fragment</strong> 可以抽出常用的結構來簡化語法</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#007020;font-weight:bold">query</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#0e84b5;font-weight:bold">me</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">...</span>UserBrief<span style="color:#bbb">
</span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span><span style="color:#bbb">  
</span><span style="color:#bbb">  </span><span style="color:#60a0b0;font-style:italic"># 可以一次定義多個 query</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>user(name:<span style="color:#bbb"> </span><span style="color:#4070a0">&#34;foo&#34;</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#0e84b5;font-weight:bold">id</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">...</span>UserBrief<span style="color:#bbb">
</span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#60a0b0;font-style:italic"># fragment 可以幫助重用參數</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">fragment</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">UserBrief</span><span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">on</span><span style="color:#bbb"> </span>User<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name<span style="color:#bbb">
</span><span style="color:#bbb">  </span>email<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p><strong>union</strong> 有時候回傳的不一定是同一種物件，這時候可以這麼做</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#60a0b0;font-style:italic"># 一個 people 可能是 Teacher 或是 Student，不同的 type 會回傳不同的內容</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">query</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">people</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">...</span><span style="color:#007020;font-weight:bold">on</span><span style="color:#bbb"> </span>Teacher<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">        </span>teacherID<span style="color:#bbb">
</span><span style="color:#bbb">        </span>name<span style="color:#bbb">
</span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">...</span><span style="color:#007020;font-weight:bold">on</span><span style="color:#bbb"> </span>Student<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">        </span>studentID<span style="color:#bbb">
</span><span style="color:#bbb">        </span>name<span style="color:#bbb">
</span><span style="color:#bbb">        </span>grade<span style="color:#bbb">
</span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#60a0b0;font-style:italic"># 等價的，你也可以寫成這樣</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">query</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">people</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">...</span>pTeacher<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">...</span>pStudent<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">fragment</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">pTeacher</span><span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">on</span><span style="color:#bbb"> </span>Teacher<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span>teacherID<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">fragment</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">pStudent</span><span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">on</span><span style="color:#bbb"> </span>Student<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span>studentID<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name<span style="color:#bbb">
</span><span style="color:#bbb">    </span>grade<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><h4 id="mutation">mutation</h4>
<p>可以簡單想像他是 RestfulAPI 中的 <code>POST</code>，用來變更資料</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#007020;font-weight:bold">mutation</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#0e84b5;font-weight:bold">newUser</span>(name:<span style="color:#bbb"> </span><span style="color:#4070a0">&#34;foo&#34;</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">email</span>:<span style="color:#bbb"> </span><span style="color:#4070a0">&#34;bar@mail.tw&#34;</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#0e84b5;font-weight:bold">id</span><span style="color:#bbb"> </span><span style="color:#60a0b0;font-style:italic"># 回傳的 id</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">...</span>UserBrief<span style="color:#bbb">
</span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">fragment</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">UserBrief</span><span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">on</span><span style="color:#bbb"> </span>User<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name<span style="color:#bbb">
</span><span style="color:#bbb">  </span>email<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p>也可以用 <code>$</code> 開頭寫點變數</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#007020;font-weight:bold">mutation</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">create</span>(<span style="color:#bb60d5">$name</span>:<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">String</span><span style="color:#bbb"> </span><span style="color:#bb60d5">$email</span>:<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">String</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span>newUser(name:<span style="color:#bbb"> </span><span style="color:#bb60d5">$name</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">email</span>:<span style="color:#bbb"> </span><span style="color:#bb60d5">$email</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#0e84b5;font-weight:bold">id</span><span style="color:#bbb"> </span><span style="color:#60a0b0;font-style:italic"># 回傳的 id</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">...</span>UserBrief<span style="color:#bbb">
</span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">fragment</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">UserBrief</span><span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">on</span><span style="color:#bbb"> </span>User<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name<span style="color:#bbb">
</span><span style="color:#bbb">  </span>email<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><h4 id="subscription">subscription</h4>
<p>建立 websocket 長連線來接收資料的變更，用法跟 query 很像，在資料變更時就收到訊息囉</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#007020;font-weight:bold">subscription</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#0e84b5;font-weight:bold">me</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name<span style="color:#bbb">
</span><span style="color:#bbb">    </span>email<span style="color:#bbb">
</span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><h3 id="introspection-自我查詢">Introspection 自我查詢</h3>
<p>GraphQL 可以利用自我查詢來取得目前的 Schema</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#007020;font-weight:bold">query</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">ListTypes</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span>__schema<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#60a0b0;font-style:italic"># 取得 gql 定義了哪些 Types</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">type</span><span style="color:#0e84b5;font-weight:bold">s</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">      </span>kind<span style="color:#bbb"> </span><span style="color:#60a0b0;font-style:italic"># Object, InputObject, Enum, Scalar</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>name<span style="color:#bbb">
</span><span style="color:#bbb">      </span>description<span style="color:#bbb">
</span><span style="color:#bbb">      
</span><span style="color:#bbb">      </span><span style="color:#60a0b0;font-style:italic"># 這裡也可以直接 fields 拿詳細資訊</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">query</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">TypeDetail</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#60a0b0;font-style:italic"># 我們想要拿 Role 這個 Type 的詳細資料</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>__type(name:<span style="color:#bbb"> </span><span style="color:#4070a0">&#34;Role&#34;</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#0e84b5;font-weight:bold">name</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>kind<span style="color:#bbb">
</span><span style="color:#bbb">    </span>fields<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">      </span>name<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>{<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">ofType</span>{<span style="color:#bbb"> </span>name<span style="color:#bbb"> </span>}<span style="color:#bbb"> </span>}<span style="color:#bbb">
</span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#007020;font-weight:bold">query</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">IntrospectionQuery</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#60a0b0;font-style:italic"># 我要拿全部操作(query, mutation, subscription)</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>__schema<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">query</span><span style="color:#0e84b5;font-weight:bold">Type</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#007020;font-weight:bold">...</span>OprationDetail<span style="color:#bbb">
</span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">mutation</span><span style="color:#0e84b5;font-weight:bold">Type</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#007020;font-weight:bold">...</span>OprationDetail<span style="color:#bbb">
</span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">subscription</span><span style="color:#0e84b5;font-weight:bold">Type</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#007020;font-weight:bold">...</span>OprationDetail<span style="color:#bbb">
</span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">fragment</span><span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">OprationDetail</span><span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">on</span><span style="color:#bbb"> </span>__Type<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name<span style="color:#bbb">
</span><span style="color:#bbb">  </span>fields<span style="color:#bbb"> </span>{<span style="color:#bbb"> 
</span><span style="color:#bbb">    </span>name<span style="color:#bbb"> 
</span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>{<span style="color:#bbb"> </span><span style="color:#0e84b5;font-weight:bold">ofType</span>{<span style="color:#bbb"> </span>name<span style="color:#bbb"> </span>}<span style="color:#bbb"> </span>}<span style="color:#bbb">
</span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p>graphQL 自帶文件，具備一般 API Server 沒有的優勢，棒棒ㄉ</p>
<h2 id="hasura">HASURA</h2>
<p><a href="https://cloud.hasura.io/project/88f267cd-3f1b-45fa-a1e1-a7ceed6ba10a/env-vars">https://cloud.hasura.io/project/88f267cd-3f1b-45fa-a1e1-a7ceed6ba10a/env-vars</a></p>
<h2 id="ref">Ref</h2>
<p>Think in GraphQL <a href="https://ithelp.ithome.com.tw/users/20111997/ironman/1878">https://ithelp.ithome.com.tw/users/20111997/ironman/1878</a>
<a href="https://graphql.org/learn/schema/">https://graphql.org/learn/schema/</a></p>

  </div>

  <div class="post-footer">
    
  </div>
</article>


  </main>
</body>

</html>
